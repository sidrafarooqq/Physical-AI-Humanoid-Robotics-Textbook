"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook=globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[824],{8453:(r,e,n)=>{n.d(e,{R:()=>i,x:()=>a});var o=n(6540);const t={},s=o.createContext(t);function i(r){const e=o.useContext(s);return o.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function a(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:i(r.components),o.createElement(s.Provider,{value:e},r.children)}},9912:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Module-1-The Robotic-Nervous-System/chapter3","title":"Chapter 3: Implementing Your First ROS 2 System","description":"Hands-On: Building a Humanoid Control Architecture","source":"@site/docs/Module-1-The Robotic-Nervous-System/chapter3.md","sourceDirName":"Module-1-The Robotic-Nervous-System","slug":"/Module-1-The Robotic-Nervous-System/chapter3","permalink":"/docs/Module-1-The Robotic-Nervous-System/chapter3","draft":false,"unlisted":false,"editUrl":"https://github.com/<your-username>/<your-repo>/tree/main/docs/Module-1-The Robotic-Nervous-System/chapter3.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 2: ROS 2 Communication Primitives","permalink":"/docs/Module-1-The Robotic-Nervous-System/chapter2"},"next":{"title":"Chapter 4: Humanoid Modeling with URDF and Xacro","permalink":"/docs/Module-1-The Robotic-Nervous-System/chapter4"}}');var t=n(4848),s=n(8453);const i={},a="Chapter 3: Implementing Your First ROS 2 System",l={},c=[{value:"Hands-On: Building a Humanoid Control Architecture",id:"hands-on-building-a-humanoid-control-architecture",level:2},{value:"Setting Up Your ROS 2 Workspace",id:"setting-up-your-ros-2-workspace",level:3},{value:"Chapter 3.1: Building Your First Publisher Node",id:"chapter-31-building-your-first-publisher-node",level:3},{value:"Chapter 3.2: Creating a Subscriber + Publisher Bridge",id:"chapter-32-creating-a-subscriber--publisher-bridge",level:3},{value:"Chapter 3.3: Service Implementation - Status Requests",id:"chapter-33-service-implementation---status-requests",level:3},{value:"Chapter 3.4: Building and Running",id:"chapter-34-building-and-running",level:3}];function d(r){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"chapter-3-implementing-your-first-ros-2-system",children:"Chapter 3: Implementing Your First ROS 2 System"})}),"\n",(0,t.jsx)(e.h2,{id:"hands-on-building-a-humanoid-control-architecture",children:"Hands-On: Building a Humanoid Control Architecture"}),"\n",(0,t.jsx)(e.p,{children:"Let's transition from theory to practice. We'll build a complete ROS 2 system where an AI agent (simulated LLM) communicates with motor controllers through ROS 2 primitives."}),"\n",(0,t.jsx)(e.h3,{id:"setting-up-your-ros-2-workspace",children:"Setting Up Your ROS 2 Workspace"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Create workspace directory structure\r\nmkdir -p ~/ros2_humanoid_ws/src\r\ncd ~/ros2_humanoid_ws/src\r\n\r\n# Create a new ROS 2 Python package\r\nros2 pkg create --build-type ament_python humanoid_controller\r\n\r\n# Navigate into the package\r\ncd humanoid_controller\r\nmkdir -p humanoid_controller launch urdf rviz\n"})}),"\n",(0,t.jsx)(e.h3,{id:"chapter-31-building-your-first-publisher-node",children:"Chapter 3.1: Building Your First Publisher Node"}),"\n",(0,t.jsxs)(e.p,{children:["Create ",(0,t.jsx)(e.code,{children:"humanoid_controller/arm_command_node.py"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\nimport random\r\nimport time\r\n\r\nclass ArmCommandNode(Node):\r\n    def __init__(self):\r\n        super().__init__('arm_command_node')\r\n        self.publisher_ = self.create_publisher(\r\n            String, \r\n            'arm_commands', \r\n            10\r\n        )\r\n        timer_period = 2.0\r\n        self.timer = self.create_timer(timer_period, self.publish_command)\r\n        self.get_logger().info('Arm Command Node initialized')\r\n        \r\n    def publish_command(self):\r\n        commands = ['wave', 'reach_forward', 'grab', 'rest', 'point']\r\n        selected = random.choice(commands)\r\n        msg = String()\r\n        msg.data = f'COMMAND:{selected}:TIMESTAMP:{time.time()}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Published: {msg.data}')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = ArmCommandNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(e.h3,{id:"chapter-32-creating-a-subscriber--publisher-bridge",children:"Chapter 3.2: Creating a Subscriber + Publisher Bridge"}),"\n",(0,t.jsxs)(e.p,{children:["Create ",(0,t.jsx)(e.code,{children:"humanoid_controller/motor_controller_node.py"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String, Float32MultiArray\r\n\r\nclass MotorControllerNode(Node):\r\n    def __init__(self):\r\n        super().__init__('motor_controller_node')\r\n        \r\n        # Subscribe to arm commands\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'arm_commands',\r\n            self.command_callback,\r\n            10\r\n        )\r\n        \r\n        # Publish motor signals\r\n        self.motor_publisher = self.create_publisher(\r\n            Float32MultiArray,\r\n            'motor_signals',\r\n            10\r\n        )\r\n        \r\n        self.get_logger().info('Motor Controller Node ready')\r\n    \r\n    def command_callback(self, msg):\r\n        self.get_logger().info(f'Received command: {msg.data}')\r\n        \r\n        # Parse command and translate to motor signals\r\n        if 'wave' in msg.data:\r\n            self.execute_wave()\r\n        elif 'reach_forward' in msg.data:\r\n            self.execute_reach_forward()\r\n        elif 'grab' in msg.data:\r\n            self.execute_grab()\r\n    \r\n    def execute_wave(self):\r\n        motor_msg = Float32MultiArray()\r\n        motor_msg.data = [45.0, 30.0, 20.0]  # Example: shoulder, elbow, wrist angles\r\n        self.motor_publisher.publish(motor_msg)\r\n        self.get_logger().info('Executing: Wave motion')\r\n    \r\n    def execute_reach_forward(self):\r\n        motor_msg = Float32MultiArray()\r\n        motor_msg.data = [0.0, 90.0, 0.0]\r\n        self.motor_publisher.publish(motor_msg)\r\n        self.get_logger().info('Executing: Reach forward')\r\n    \r\n    def execute_grab(self):\r\n        motor_msg = Float32MultiArray()\r\n        motor_msg.data = [30.0, 60.0, -45.0]\r\n        self.motor_publisher.publish(motor_msg)\r\n        self.get_logger().info('Executing: Grab object')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MotorControllerNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(e.h3,{id:"chapter-33-service-implementation---status-requests",children:"Chapter 3.3: Service Implementation - Status Requests"}),"\n",(0,t.jsxs)(e.p,{children:["Create ",(0,t.jsx)(e.code,{children:"humanoid_controller/status_service_node.py"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_srvs.srv import Trigger\r\n\r\nclass StatusServiceNode(Node):\r\n    def __init__(self):\r\n        super().__init__('status_service_node')\r\n        self.service = self.create_service(\r\n            Trigger,\r\n            'get_robot_status',\r\n            self.status_callback\r\n        )\r\n        self.robot_ready = True\r\n        self.get_logger().info('Status Service Node ready')\r\n    \r\n    def status_callback(self, request, response):\r\n        response.success = self.robot_ready\r\n        response.message = f'Robot Status: {\"READY\" if self.robot_ready else \"ERROR\"}'\r\n        self.get_logger().info(f'Status requested: {response.message}')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = StatusServiceNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(e.h3,{id:"chapter-34-building-and-running",children:"Chapter 3.4: Building and Running"}),"\n",(0,t.jsxs)(e.p,{children:["Update ",(0,t.jsx)(e.code,{children:"setup.py"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from setuptools import setup, find_packages\r\n\r\nsetup(\r\n    name='humanoid_controller',\r\n    version='0.0.1',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/humanoid_controller', ['package.xml']),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'arm_command = humanoid_controller.arm_command_node:main',\r\n            'motor_controller = humanoid_controller.motor_controller_node:main',\r\n            'status_service = humanoid_controller.status_service_node:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,t.jsx)(e.p,{children:"Build and test:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"cd ~/ros2_humanoid_ws\r\ncolcon build\r\nsource install/setup.bash\r\n\r\n# Terminal 1: Run arm command publisher\r\nros2 run humanoid_controller arm_command\r\n\r\n# Terminal 2: Run motor controller subscriber\r\nros2 run humanoid_controller motor_controller\r\n\r\n# Terminal 3: Monitor communication\r\nros2 topic echo arm_commands\n"})}),"\n",(0,t.jsx)(e.hr,{})]})}function m(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(d,{...r})}):d(r)}}}]);